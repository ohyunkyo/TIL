{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/django-rest-framework/create-xls-file-and-return-it/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Today I Learned"}},"markdownRemark":{"id":"167c3a17-c621-5fbb-ad14-8e71837c309f","excerpt":"0. 서론 엑셀 파일 생성에 필요한 dataframe 을 완성했다. 그리고  메서드를 사용해 프로젝트 내부에 엑셀도 생성해 봤다. 이제 프로젝트 내부가 아닌 Http response 에 엑셀 파일을 담아 리턴해주기만 하면 된다. 1. 엑셀 파일이 포함된 response…","html":"<h2>0. 서론</h2>\n<p>엑셀 파일 생성에 필요한 dataframe 을 완성했다. 그리고 <code class=\"language-text\">to_excel()</code> 메서드를 사용해 프로젝트 내부에 엑셀도 생성해 봤다.<br>\n이제 프로젝트 내부가 아닌 Http response 에 엑셀 파일을 담아 리턴해주기만 하면 된다.</p>\n<h2>1. 엑셀 파일이 포함된 response 생성하기</h2>\n<p>어떤 원리인지는 잘 모르겠다. 일단 <code class=\"language-text\">to_excel()</code> 메서드의 <code class=\"language-text\">excel_writer</code> 인자는 엑셀이 생성될 위치를 포함한 여러 정보를 전달받게 되는것 같은데,\r\n여기에 HttpResponse 객체를 넣어주게 되면 해당 응답객체에 엑셀 파일이 삽입되는것 같다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">response <span class=\"token operator\">=</span> HttpResponse<span class=\"token punctuation\">(</span>headers<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>\r\n    <span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'application/vnd.ms-excel'</span><span class=\"token punctuation\">,</span>\r\n    <span class=\"token string\">'Content-Disposition'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'attachment; filename*=UTF-8\\'\\'purchase_order_'</span> <span class=\"token operator\">+</span> date_string <span class=\"token operator\">+</span> <span class=\"token string\">'.xls'</span>\r\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\r\n\r\ndf<span class=\"token punctuation\">.</span>to_excel<span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">,</span> index<span class=\"token operator\">=</span><span class=\"token boolean\">False</span><span class=\"token punctuation\">,</span> engine<span class=\"token operator\">=</span><span class=\"token string\">'xlwt'</span><span class=\"token punctuation\">)</span>\r\n\r\n<span class=\"token keyword\">return</span> response</code></pre></div>\n<p><a href=\"https://stackoverflow.com/questions/35267585/django-pandas-to-http-response-download-file\">출처1</a>\r\n<a href=\"https://gist.github.com/jonperron/733c3ead188f72f0a8a6f39e3d89295d\">출처2</a></p>","frontmatter":{"title":"엑셀 파일 HttpResponse 에 담아 전달하기","date":"April 13, 2022","description":null},"fields":{"category":"django-rest-framework","slug":"/django-rest-framework/create-xls-file-and-return-it/"}},"previous":{"fields":{"slug":"/django/tht-django-pandas-i-know/"},"frontmatter":{"title":"내가 사용해본 django-pandas"}},"next":{"fields":{"slug":"/django/django-db-transaction/"},"frontmatter":{"title":"django 에서 트랜잭션 적용하기"}}},"pageContext":{"id":"167c3a17-c621-5fbb-ad14-8e71837c309f","previousPostId":"47f88826-f242-5ddb-8765-6125a4f794ae","nextPostId":"effd14f2-b610-5927-b3f6-a05ead41f7f7"}},
    "staticQueryHashes": ["230163734","2841359383","3496359572"]}